import{A as n,r as i,j as t,F as k,D as z,P as T,C as W,v as G,k as v,w as H,x as X,m as J,c as N,E as K}from"./index-CG9mGcM9.js";import{u as Q,C as Y,a as Z,b as I,c as g,d as ee,e as te,f,g as re}from"./useCrudPanel-DUkQ6LXF.js";const x="businesses";function se(e){return e.map(({...r})=>({...r}))}async function fe(){const e=await n({resource:x});return se(e)}async function me({data:e}){return await n({resource:x,data:e,method:"POST",all:!0,formData:!0})}async function xe({id:e,data:r}){return await n({resource:x+"/"+e,data:r,method:"POST",all:!0,formData:!0})}async function he({id:e}){return await n({resource:x+"/"+e,method:"DELETE",all:!0})}function ye({children:e}){const[r,a]=i.useState(!1),c=i.useRef(null);return i.useEffect(()=>{function u(d){c.current&&!c.current.contains(d.target)&&a(!1)}return document.addEventListener("click",u),()=>{document.removeEventListener("click",u)}},[]),t.jsx("div",{ref:c,className:"flex flex-col justify-center items-center w-full",children:t.jsxs("div",{className:"relative w-10 aspect-square",children:[t.jsx("button",{className:"flex justify-center items-center w-full h-full rounded-full cursor-pointer opacity-60 hover:opacity-100 hover:bg-black/10",onClick:()=>a(!r),children:t.jsx(k,{icon:z,className:"text-lg"})}),t.jsx("div",{className:"absolute right-[calc(100%+5px)] top-[50%] translate-y-[-50%] overflow-hidden flex h-auto gap-1 bg-white/40 rounded-lg shadow "+(r?"max-w-[500px] p-2 opacity-100":"max-w-0 p-0 opacity-0"),children:e})]})})}const h="products";function ae(e){return e.map(({...r})=>({...r}))}async function ne(){const e=await n({resource:h+"?includeCategory=true"});return ae(e)}async function oe({data:e}){return await n({resource:h+"?includeCategory=true",data:e,method:"POST",all:!0,formData:!0})}async function ce({id:e,data:r}){return await n({resource:h+"/"+e+"?includeCategory=true",data:r,method:"POST",all:!0,formData:!0})}async function ue({id:e}){return await n({resource:h+"/"+e,method:"DELETE",all:!0})}const m="categories";function D(e){return e.map(({...r})=>({...r}))}async function ie(){const e=await n({resource:m});return D(e)}async function ge(){const e=await n({resource:m+"?includeBusiness=true"});return D(e)}async function Ce({data:e}){return await n({resource:m+"?includeBusiness=true",data:e,method:"POST",all:!0})}async function je({id:e,data:r}){return await n({resource:m+"/"+e+"?includeBusiness=true",data:r,method:"PUT",all:!0,printResponse:!0})}async function we({id:e}){return await n({resource:m+"/"+e,method:"DELETE",all:!0})}function le({businessId:e=null}){const r=(s,l)=>{var w,b,E,P;let o=!0;return(b=(w=s.photo)==null?void 0:w.files)!=null&&b.length&&((P=(E=s.photo)==null?void 0:E.files[0])==null?void 0:P.size)>2e6&&(l("La foto debe pesar maximo 2MB"),o=!1),o},{entityName:a,pluralEntityName:c,head:u,table:d,form:O,confirm:S,progress:B,datalist:p,$form:F,handleModeNew:M,handleModeEdit:L,handleModeDelete:R,hanleCancel:C,handleSubmit:q,handleDelete:_,searchValue:U,searchOnChange:V}=Q({entityName:"Product",pluralEntityName:"Productos",excludeFieldsValidationEdit:["photo"],searchFields:["name","description","price"],extraValidations:r,isStorageMultipartFormData:!0,isUpdateMultipartFormData:!0,crudGet:ne,crudStorage:oe,crudUpdate:ce,crudDestroy:ue}),[$,j]=i.useState([]);i.useEffect(()=>{ie().then(s=>{if(!s)return;if(!e)return j(s);const l=s.filter(o=>(o==null?void 0:o.business_id)==e);j(l)})},[e]);const[A,y]=i.useState(null);return i.useEffect(()=>{if(!e||!p)return y(p);const s=p.filter(l=>{var o;return((o=l==null?void 0:l.category)==null?void 0:o.business_id)==e});y(s)},[e,p]),t.jsxs(T,{className:"flex flex-col gap-7 w-full",children:[!e&&t.jsx(W,{src:"/image/food3.jpg"}),t.jsx(Y,{title:c,icon:G,isOpen:u,onClickNew:M,searchValue:U,searchOnChange:V}),t.jsx(Z,{titles:["Foto","Nombre","Descripcion","Precio"],dataList:A,isOpen:d,onRowPrint:s=>t.jsxs("tr",{children:[t.jsx(I,{src:s.photo_url,alt:"Foto "+s.name}),t.jsx(g,{value:s.name}),t.jsx(g,{value:s.description}),t.jsx(g,{value:s.price}),t.jsxs(ee,{children:[t.jsx(v,{text:"Editar",icon:H,type:"edit",onClick:()=>L(s)}),t.jsx(v,{text:"Borrar",icon:X,type:"delete",onClick:()=>R(s)})]})]},s.id)}),t.jsxs(te,{title:a,isOpen:O,onClickCancel:C,onSubmit:q,formRef:F,children:[t.jsx(f,{label:"Nombre",placeholder:"Escriba el nombre del producto",name:"name",required:!0}),t.jsx(f,{label:"Descripcion",placeholder:"Escriba una descripcion",name:"description",required:!0}),t.jsx(f,{label:"Precio",placeholder:"Escriba su numero de celular",name:"price",required:!0}),t.jsx(f,{label:"Foto",name:"photo",type:"file"}),t.jsxs(f,{label:"Categoria",name:"category_id",type:"select",required:!0,children:[t.jsx("option",{value:"",children:"Seleccione una categoria"}),$.map(s=>t.jsx("option",{value:s.id,children:s.name},s.id))]})]}),t.jsx(re,{isOpen:S,text:"Â¿Seguro de eliminar este usuario?",onClickDelete:_,onClickCancel:C}),t.jsx(J,{isOpen:B,text:"Procesando tu solicitud..."})]})}function be({businessId:e,setBusinessId:r}){const a=e!==null,c=()=>r(null),u=i.useRef();return document.addEventListener("click",d=>{u.current&&d.target===u.current&&c()}),t.jsx(T,{className:N("fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-[1000] w-full h-full bg-black/40",{"w-0 h-0 overflow-hidden opacity-0":!a,"w-full h-full opacity-100":a}),children:t.jsxs("div",{ref:u,className:"relative flex justify-center items-center w-full h-full cursor-pointer",children:[t.jsx("button",{className:"absolute top-1 right-1 flex justify-center items-center w-10 aspect-square rounded-full bg-black/50 opacity-50 hover:opacity-100 transition-all duration-200 cursor-pointer",onClick:c,children:t.jsx(k,{icon:K,className:"text-white text-2xl"})}),t.jsx("div",{className:N("container flex justify-center items-center bg-white rounded-xl",{"p-[--pdd]":a,"p-0":!a}),children:a&&t.jsx(le,{businessId:e})})]})})}export{ye as C,be as M,ge as a,Ce as b,je as c,he as d,we as e,fe as g,me as s,xe as u};
